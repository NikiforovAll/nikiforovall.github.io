<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Announcement - Keycloak.AuthServices v2.3.0 is out üéâ! | N+1 Blog</title>

	<!-- Meta Description -->
	
	<meta name="description" content="Protected Resource Builder, Improved Logging and Observability including OpenTelemetry support, and more! üôå">
	

	<meta name="author" content="Oleksii Nikiforov">

	<!-- Canonical URL -->
	<link rel="canonical" href="http://localhost:4000/dotnet/keycloak/2024/05/10/keycloak-v2-3-0.html">

	<!-- Open Graph -->
	<meta property="og:title" content="Announcement - Keycloak.AuthServices v2.3.0 is out üéâ!">
	<meta property="og:description" content="Protected Resource Builder, Improved Logging and Observability including OpenTelemetry support, and more! üôå">
	<meta property="og:url" content="http://localhost:4000/dotnet/keycloak/2024/05/10/keycloak-v2-3-0.html">
	<meta property="og:site_name" content="N+1 Blog">
	<meta property="og:type" content="article">
	
	<meta property="article:published_time" content="2024-05-10T00:00:00+03:00">
	
	<meta property="og:image" content="http://localhost:4000/assets/media/default-post-image.png">

	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@nikiforovall">
	<meta name="twitter:title" content="Announcement - Keycloak.AuthServices v2.3.0 is out üéâ!">
	<meta name="twitter:description" content="Protected Resource Builder, Improved Logging and Observability including OpenTelemetry support, and more! üôå">
	<meta name="twitter:image" content="http://localhost:4000/assets/media/default-post-image.png">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Search Feature Styles -->
	<style>
		.layout-page .search-trigger { position: fixed; top: 45px; right: 100px; z-index: 1000; display: flex; align-items: center; gap: 10px; padding: 6px 12px; background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; min-width: 220px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); transition: all 0.15s ease; height: 34px; box-sizing: border-box; }
		.layout-post .search-trigger { position: fixed; top: 45px; right: 100px; z-index: 1000; display: flex; align-items: center; justify-content: center; padding: 0; background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; width: 34px; height: 34px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); transition: all 0.15s ease; box-sizing: border-box; }
		.search-trigger:hover { background: #ebebeb; border-color: #c0c0c0; box-shadow: 0 2px 5px rgba(0,0,0,0.08); }
		.search-icon { color: #666; font-size: 14px; display: flex; align-items: center; }
		.search-placeholder { flex: 1; color: #999; font-size: 14px; user-select: none; }
		.search-keybind { display: flex; gap: 4px; align-items: center; }
		.search-key { font-family: 'Courier New', monospace; font-size: 11px; padding: 2px 6px; background: #e0e0e0; border: 1px solid #ccc; border-bottom: 2px solid #bbb; border-radius: 3px; color: #333; line-height: 1.2; box-shadow: 0 1px 1px rgba(0,0,0,0.1); }
		.layout-post .search-placeholder { display: none; }
		.layout-post .search-keybind { display: none; }
		.search-modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 10000; display: none; align-items: flex-start; justify-content: center; padding-top: 10vh; }
		.search-modal.open { display: flex; animation: fadeIn 0.2s ease; }
		@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
		.search-backdrop { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(2px); }
		.search-modal-container { position: relative; width: 90%; max-width: 600px; background: white; border-radius: 8px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3); overflow: hidden; }
		.search-input-container { display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid #e0e0e0; gap: 12px; }
		.search-modal-icon { color: #666; font-size: 18px; }
		.search-modal-input { flex: 1; border: none; outline: none; font-size: 16px; color: #333; background: transparent; }
		.search-modal-input::placeholder { color: #999; }
		.search-close-btn { background: transparent; border: none; color: #999; font-size: 18px; cursor: pointer; padding: 4px 8px; border-radius: 4px; transition: all 0.15s ease; }
		.search-close-btn:hover { background: #f0f0f0; color: #333; }
		.search-results { max-height: 60vh; overflow-y: auto; padding: 8px; }
		.search-hint { padding: 40px 20px; text-align: center; color: #999; font-size: 14px; }
		.search-result-item { padding: 12px 16px; border-radius: 6px; cursor: pointer; transition: background-color 0.15s ease; border: 2px solid transparent; margin-bottom: 4px; }
		.search-result-item:hover { background: #f5f5f5; }
		.search-result-item.selected { background: #e8f4f8; border-color: #4a90e2; }
		.search-footer { display: flex; justify-content: center; gap: 20px; padding: 12px 20px; border-top: 1px solid #e0e0e0; background: #fafafa; font-size: 12px; color: #666; }
		.search-footer kbd { font-family: 'Courier New', monospace; font-size: 11px; padding: 2px 5px; background: white; border: 1px solid #ddd; border-radius: 3px; color: #333; box-shadow: 0 1px 1px rgba(0,0,0,0.1); }
		@media (max-width: 768px) { .layout-page .search-trigger, .layout-post .search-trigger { display: none; } .search-modal { padding-top: 5vh; } .search-modal-container { width: 95%; max-width: none; margin: 0 10px; } .search-results { max-height: 50vh; } .search-footer { flex-wrap: wrap; gap: 10px; } }
	</style>

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->
	<link rel="shortcut icon" href="/assets/media/favicon.ico">

	<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

	
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Announcement - Keycloak.AuthServices v2.3.0 is out üéâ!",
  
  
  "description": "Protected Resource Builder, Improved Logging and Observability including OpenTelemetry support, and more! üôå",
  
  "image": ["http://localhost:4000/assets/media/default-post-image.png"],
  "datePublished": "2024-05-10T00:00:00+03:00",
  "dateModified": "2024-05-10T00:00:00+03:00",
  "author": {
    "@type": "Person",
    "name": "Oleksii Nikiforov",
    "url": "http://localhost:4000/about.html",
    "sameAs": [
      "https://github.com/nikiforovAll",
      "https://twitter.com/nikiforovall",
      "https://www.linkedin.com/in/nikiforov-oleksii",
      "https://t.me/nikiforovallblog"
    ]
  },
  "publisher": {
    "@type": "Person",
    "name": "Oleksii Nikiforov",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.gravatar.com/avatar/e86fa0938976c38907a302ecb208f011?s=200"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:4000/dotnet/keycloak/2024/05/10/keycloak-v2-3-0.html"
  },
  
  "articleSection": "dotnet",
  
  
  "keywords": "aspnetcore, dotnet, keycloak, auth",
  
  "inLanguage": "en-US"
}
</script>


</head>

<body class="layout-post">
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/nikiforovAll" target="_blank" rel="noopener noreferrer noopener noreferrer">
				<i class="fa-brands fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://x.com/nikiforovall" target="_blank" rel="noopener noreferrer noopener noreferrer">
				<i class="fa-brands fa-x-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:alexey.nikiforovall@gmail.com">
				<i class="fa-solid fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/e86fa0938976c38907a302ecb208f011?s=35" class="img-circle">
				N+1 Blog
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/topics.html">Topics</a></li>
				<li><a href="/about.html">About</a></li>
			</ul>
		</div>
<!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa-solid fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa-solid fa-home"></i>Home</a></li>
			<li><a href="/topics.html"><i class="fa-solid fa-bookmark"></i>Topics</a></li>
			<li><a href="/about.html"><i class="fa-solid fa-pencil"></i>About</a></li>
			<li class="divider">
			<li><a href="#"><i class="fa-solid fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<!-- Search Control -->
	<button id="search-trigger" class="search-trigger" type="button" aria-label="Open search">
		<span class="search-icon"><i class="fa-solid fa-search"></i></span>
		<span class="search-placeholder">Search</span>
		<div class="search-keybind">
			<kbd class="search-key" id="search-modifier">ctrl</kbd>
			<kbd class="search-key">K</kbd>
		</div>
	</button>

	<!-- Search Modal -->
	<div id="search-modal" class="search-modal">
		<div class="search-backdrop"></div>
		<div class="search-modal-container">
			<div class="search-input-container">
				<i class="fa-solid fa-search search-modal-icon"></i>
				<input type="text" id="search-input" class="search-modal-input" placeholder="Search blog posts..." autocomplete="off">
				<button id="search-close" class="search-close-btn" title="Close (ESC)">
					<i class="fa-solid fa-times"></i>
				</button>
			</div>
			<div id="search-results" class="search-results">
				<div class="search-hint">Type at least 2 characters to search...</div>
			</div>
			<div class="search-footer">
				<span><kbd>‚Üë</kbd> <kbd>‚Üì</kbd> to navigate</span>
				<span><kbd>‚Üµ</kbd> to select</span>
				<span><kbd>ESC</kbd> to close</span>
			</div>
		</div>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/" class="profile-link">
		<img src="//www.gravatar.com/avatar/e86fa0938976c38907a302ecb208f011?s=150" class="img-circle profile-image">
		<div class="profile-accent"></div>
	</a>
	<h3 class="title">
        <a href="/">N+1 Blog</a>
    </h3>
</header>


<div id="bio" class="text-center">
	Jibber-jabbering about programming and IT.
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/nikiforovAll" target="_blank" rel="noopener noreferrer noopener noreferrer">
				<i class="fa-brands fa-github fa-xl"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://x.com/nikiforovall" target="_blank" rel="noopener noreferrer noopener noreferrer">
				<i class="fa-brands fa-x-twitter fa-xl"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://t.me/nikiforovallblog" target="_blank" rel="noopener noreferrer noopener noreferrer">
				<i class="fa-brands fa-telegram fa-xl"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/nikiforov-oleksii" target="_blank" rel="noopener noreferrer noopener noreferrer">
				<i class="fa-brands fa-linkedin fa-xl"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:alexey.nikiforovall@gmail.com">
				<i class="fa-solid fa-envelope fa-xl"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml" target="_blank" rel="noopener noreferrer">
				<i class="fa-solid fa-rss fa-xl"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
	<h1>Announcement - Keycloak.AuthServices v2.3.0 is out üéâ! </h1>
</div>
<article>

	<div class="col-sm-10">

		<span class="post-date">
			
			May
			10th,
			
			2024
		</span>

	
	
	
	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	
	<div>
		<h5><a href="/dotnet/keycloak/2024/06/02/aspire-support-for-keycloak.html">Using Keycloak in .NET Aspire projects <span class="label label-default">dotnet</span>  <span class="label label-default">aspnetcore</span>  <span class="label label-default">keycloak</span> </a></h5>
	</div>
	
	
	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	
	<div>
		<h5><a href="/dotnet/keycloak/2024/05/05/keycloak-v2-0-0.html">Announcement - Keycloak.AuthServices v2.0.0 is out üéâ! <span class="label label-default">aspnetcore</span>  <span class="label label-default">dotnet</span>  <span class="label label-default">keycloak</span>  <span class="label label-default">auth</span> </a></h5>
	</div>
	
	
	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	

	

	
	

	

	
	<div>
		<h5><a href="/dotnet/keycloak/2022/12/28/keycloak-authorization-server.html">Keycloak as Authorization Server in .NET <span class="label label-default">aspnetcore</span>  <span class="label label-default">dotnet</span>  <span class="label label-default">auth</span>  <span class="label label-default">keycloak</span> </a></h5>
	</div>
	
	
	

	

	
	

	

	
	<div>
		<h5><a href="/blazor/dotnet/2022/12/08/dotnet-keycloak-blazorwasm-auth.html">Use Keycloak as Identity Provider from Blazor WebAssembly (WASM) applications <span class="label label-default">aspnetcore</span>  <span class="label label-default">dotnet</span>  <span class="label label-default">auth</span>  <span class="label label-default">keycloak</span> </a></h5>
	</div>
	
	
	
	

	<div class="article_body" style="margin-top: 30px;">
		<h2 id="announcement">Announcement</h2>

<p>I‚Äôm happy to announce the release of <a href="https://github.com/NikiforovAll/keycloak-authorization-services-dotnet" target="_blank" rel="noopener noreferrer">Keycloak.AuthServices 2.3.0</a> packages üéâ. The release includes Protected Resource Builder, Improved Observability including OpenTelemetry support, and more! üôå</p>

<p>Check out the documentation to see all the cool new features and improvements: <a href="https://nikiforovall.github.io/keycloak-authorization-services-dotnet/" target="_blank" rel="noopener noreferrer">https://nikiforovall.github.io/keycloak-authorization-services-dotnet/</a></p>

<hr>

<blockquote>
  <p>Join us on Discord: <a href="https://discord.gg/jdYFw2xq" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/discord/1236946465318768670?color=blue&amp;label=Chat%20on%20Discord" alt="Discord"></a></p>
</blockquote>

<p><img src="/assets/keycloak-v2/keycloak-landing.png"></p>

<table>
  <thead>
    <tr>
      <th>Package</th>
      <th>Version</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Keycloak.AuthServices.Authentication</code></td>
      <td><a href="https://nuget.org/packages/Keycloak.AuthServices.Authentication" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/v/Keycloak.AuthServices.Authentication.svg" alt="Nuget"></a></td>
      <td>Keycloak Authentication for API and Web Apps</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Keycloak.AuthServices.Authorization</code></td>
      <td><a href="https://nuget.org/packages/Keycloak.AuthServices.Authorization" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/v/Keycloak.AuthServices.Authorization.svg" alt="Nuget"></a></td>
      <td>Authorization Services.  Keycloak Authorization Server integration ‚ú®</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Keycloak.AuthServices.Sdk</code></td>
      <td><a href="https://nuget.org/packages/Keycloak.AuthServices.Sdk" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/v/Keycloak.AuthServices.Sdk.svg" alt="Nuget"></a></td>
      <td>HTTP API integration with Admin API and Protection API</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Keycloak.AuthServices.Sdk.Kiota</code></td>
      <td><a href="https://nuget.org/packages/Keycloak.AuthServices.Sdk.Kiota" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/v/Keycloak.AuthServices.Sdk.Kiota.svg" alt="Nuget"></a></td>
      <td>HTTP API integration for Admin API based on OpenAPI</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Keycloak.AuthServices.OpenTelemetry</code></td>
      <td><a href="https://nuget.org/packages/Keycloak.AuthServices.OpenTelemetry" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/nuget/v/Keycloak.AuthServices.OpenTelemetry.svg" alt="Nuget"></a></td>
      <td>OpenTelemetry support</td>
    </tr>
  </tbody>
</table>

<h2 id="changelog">Changelog</h2>

<ul>
  <li>üë∑‚Äç‚ôÇÔ∏è Protected Resource Builder
    <ul>
      <li><a href="#protected-resource-builder---minimal-api">Minimal API</a></li>
      <li><a href="#protected-resource-builder---mvc">MVC</a></li>
    </ul>
  </li>
  <li>üé≠ <a href="#improved-claims-transformation">Improved Role Claim Transformation</a>
</li>
  <li>üÜï <a href="#opentelemetry-support">Added OpenTelemetry support</a> <code class="language-plaintext highlighter-rouge">Keycloak.AuthServices.OpenTelemetry</code>
</li>
  <li>üóíÔ∏è <a href="#maintenance-documentation">Added improved docs</a> - added ‚ÄúMaintenance‚Äù section and more!</li>
</ul>

<h2 id="protected-resource-builder---minimal-api">Protected Resource Builder - Minimal API</h2>

<p>Protected Resource Builder approach provides a convenient way to authorize resources, making it easier to manage and maintain authorization rules using Authorization Server. No need to register policies!</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">WebApplication</span><span class="p">.</span><span class="nf">CreateBuilder</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">services</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">;</span>

<span class="n">services</span>
    <span class="p">.</span><span class="nf">AddAuthentication</span><span class="p">(</span><span class="n">JwtBearerDefaults</span><span class="p">.</span><span class="n">AuthenticationScheme</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">AddKeycloakWebApi</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="n">Configuration</span><span class="p">);</span>

<span class="n">services</span>
    <span class="p">.</span><span class="nf">AddAuthorization</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">AddKeycloakAuthorization</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">AddAuthorizationServer</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="n">Configuration</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">app</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="nf">Build</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseAuthentication</span><span class="p">();</span>
<span class="n">app</span><span class="p">.</span><span class="nf">UseAuthorization</span><span class="p">();</span>


<span class="n">app</span><span class="p">.</span><span class="nf">MapGet</span><span class="p">(</span><span class="s">"/workspaces"</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="s">"Hello World!"</span><span class="p">)</span> 
    <span class="p">.</span><span class="nf">RequireProtectedResource</span><span class="p">(</span><span class="s">"workspaces"</span><span class="p">,</span> <span class="s">"workspace:read"</span><span class="p">);</span> 
<span class="n">app</span><span class="p">.</span><span class="nf">Run</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="protected-resource-builder---mvc">Protected Resource Builder - MVC</h2>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Program.cs</span>
<span class="kt">var</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">WebApplication</span><span class="p">.</span><span class="nf">CreateBuilder</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">services</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">;</span>

<span class="n">services</span><span class="p">.</span><span class="nf">AddControllers</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span> <span class="n">options</span><span class="p">.</span><span class="nf">AddProtectedResources</span><span class="p">());</span> 

<span class="n">services</span>
    <span class="p">.</span><span class="nf">AddAuthentication</span><span class="p">(</span><span class="n">JwtBearerDefaults</span><span class="p">.</span><span class="n">AuthenticationScheme</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">AddKeycloakWebApi</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Configuration</span><span class="p">);</span>

<span class="n">services</span>
    <span class="p">.</span><span class="nf">AddAuthorization</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">AddKeycloakAuthorization</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">AddAuthorizationServer</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Configuration</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">app</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="nf">Build</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseHttpsRedirection</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseAuthorization</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">MapControllers</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">Run</span><span class="p">();</span>
</code></pre></div></div>

<p>Here is how to use it in Controllers:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">ApiController</span><span class="p">]</span>
<span class="p">[</span><span class="nf">Route</span><span class="p">(</span><span class="s">"workspaces"</span><span class="p">)]</span>
<span class="p">[</span><span class="nf">ProtectedResource</span><span class="p">(</span><span class="s">"workspaces"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">WorkspacesController</span> <span class="p">:</span> <span class="n">ControllerBase</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">ProtectedResource</span><span class="p">(</span><span class="s">"workspaces"</span><span class="p">,</span> <span class="s">"workspace:list"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;&gt;</span> <span class="nf">GetWorkspacesAsync</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">Ok</span><span class="p">(</span><span class="n">Array</span><span class="p">.</span><span class="n">Empty</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;());</span>

    <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"public"</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">IgnoreProtectedResource</span><span class="p">]</span>
    <span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">GetPublicWorkspaceAsync</span><span class="p">()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">Ok</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="s">"public"</span> <span class="p">});</span>

    <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">ProtectedResource</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">,</span> <span class="s">"workspace:read"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">GetWorkspaceAsync</span><span class="p">(</span><span class="kt">string</span> <span class="n">id</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nf">Ok</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">id</span> <span class="p">});</span>

    <span class="p">[</span><span class="nf">HttpDelete</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">ProtectedResource</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">,</span> <span class="s">"workspace:delete"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">DeleteWorkspaceAsync</span><span class="p">(</span><span class="kt">string</span> <span class="n">id</span><span class="p">)</span> <span class="p">=&gt;</span>
        <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nf">BadRequest</span><span class="p">()</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nf">NoContent</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>See: <a href="https://nikiforovall.github.io/keycloak-authorization-services-dotnet/authorization/protected-resource-builder.html" target="_blank" rel="noopener noreferrer">https://nikiforovall.github.io/keycloak-authorization-services-dotnet/authorization/protected-resource-builder.html</a></p>

<h2 id="improved-claims-transformation">Improved Claims Transformation</h2>

<p>You can now map both Realm Roles and Client Roles.</p>

<p>See the <a href="https://nikiforovall.github.io/keycloak-authorization-services-dotnet/configuration/configuration-authorization.html#keycloak-role-claims-transformation" target="_blank" rel="noopener noreferrer">docs</a> for more details.</p>

<h2 id="opentelemetry-support">OpenTelemetry support</h2>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">WebApplication</span><span class="p">.</span><span class="nf">CreateBuilder</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">services</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">;</span>

<span class="n">builder</span><span class="p">.</span><span class="n">Logging</span><span class="p">.</span><span class="nf">AddOpenTelemetry</span><span class="p">(</span><span class="n">logging</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">IncludeFormattedMessage</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">logging</span><span class="p">.</span><span class="n">IncludeScopes</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="p">});</span>

<span class="n">services</span>
    <span class="p">.</span><span class="nf">AddOpenTelemetry</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">WithMetrics</span><span class="p">(</span><span class="n">metrics</span> <span class="p">=&gt;</span>
        <span class="n">metrics</span>
            <span class="p">.</span><span class="nf">AddAspNetCoreInstrumentation</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">AddHttpClientInstrumentation</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">AddKeycloakAuthServicesInstrumentation</span><span class="p">()</span> <span class="c1">// &lt;-- add this</span>
    <span class="p">)</span>
    <span class="p">.</span><span class="nf">WithTracing</span><span class="p">(</span><span class="n">tracing</span> <span class="p">=&gt;</span>
        <span class="n">tracing</span>
            <span class="p">.</span><span class="nf">AddAspNetCoreInstrumentation</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">AddHttpClientInstrumentation</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">AddKeycloakAuthServicesInstrumentation</span><span class="p">()</span> <span class="c1">// &lt;-- add this</span>
    <span class="p">)</span>
    <span class="p">.</span><span class="nf">UseOtlpExporter</span><span class="p">();</span>
</code></pre></div></div>

<p>See the <a href="https://nikiforovall.github.io/keycloak-authorization-services-dotnet/opentelemetry.html" target="_blank" rel="noopener noreferrer">docs</a> for more details.</p>

<h3 id="maintenance-documentation">Maintenance Documentation</h3>

<p>Includes common recipes and troubleshooting guidelines.</p>

<p>See the <a href="https://nikiforovall.github.io/keycloak-authorization-services-dotnet/qa/recipes.html" target="_blank" rel="noopener noreferrer">docs</a> for more details.</p>

<h2 id="feedback">Feedback</h2>

<p>I‚Äôm excited to hear your thoughts and suggestions! Please let me know which aspects of the functionality you‚Äôd like me to explore in the next blog post. Leave your recommendations in the comments section below. Your feedback is greatly appreciated! üôè</p>

	</div>

	

	
	<ul class="list-inline">
		<li>
<i class="fa-solid fa-bookmark"></i> Topics:</li>
		
		
		
		<li>
			<a href="/topics.html#dotnet-cat-ref">
				dotnet <span>(59)</span>
			</a>
			 ¬∑
		</li>
		
		<li>
			<a href="/topics.html#keycloak-cat-ref">
				keycloak <span>(4)</span>
			</a>
			 ¬∑
		</li>
		
		
		
		
		
		<li>
			<a href="/topics.html#aspnetcore-tag-ref">
				aspnetcore <span>(24)</span>
			</a>
			 ¬∑
		</li>
		
		<li>
			<a href="/topics.html#dotnet-tag-ref">
				dotnet <span>(64)</span>
			</a>
			 ¬∑
		</li>
		
		<li>
			<a href="/topics.html#keycloak-tag-ref">
				keycloak <span>(6)</span>
			</a>
			 ¬∑
		</li>
		
		<li>
			<a href="/topics.html#auth-tag-ref">
				auth <span>(5)</span>
			</a>
			
		</li>
		
		
		
	</ul>
	

	<hr>

	<div>
		<section class="share col-sm-6">
			<h4 class="section-title">Share Post</h4>
			<a class="btn btn-default btn-sm twitter" href="http://x.com/share?&amp;via=nikiforovall" onclick="window.open(this.href, 'x-share', 'width=550,height=235');return false;" target="_blank" rel="noopener noreferrer">
				<i class="fa-brands fa-x-twitter fa-lg"></i>
				X
			</a>
		</section>

		<section class="col-sm-6 author">
			<img src="//www.gravatar.com/avatar/e86fa0938976c38907a302ecb208f011" class="img-rounded author-image">
			<h4 class="section-title author-name">Oleksii Nikiforov</h4>
			<p class="author-bio">Jibber-jabbering about programming and IT.</p>
		</section>
	</div>

	<div class="clearfix"></div>

	<ul class="pager">
		
		<li class="previous"><a href="/dotnet/keycloak/2024/05/05/keycloak-v2-0-0.html" title="Announcement - Keycloak.AuthServices v2.0.0 is out üéâ!">‚Üê
				Previous</a></li>
		
		
		<li class="next">
<a href="/dotnet/aws/2024/05/26/aws-batch-dotnet.html" title="Mastering AWS Batch: A .NET Developer Guide to Batch File Processing">Next ‚Üí</a>
		</li>
		
	</ul>

	<hr>
	</div>

	<div class="col-sm-2 sidebar-2">

	</div>

</article>
<div class="clearfix"></div>



    
    <script src="https://utteranc.es/client.js" repo="NikiforovAll/nikiforovall.github.io" issue-term="pathname" label="Blog" theme="preferred-color-scheme" crossorigin="anonymous" async>
    </script>





		<footer>
			<hr>
			<p>
				¬© 2026 Oleksii Nikiforov with <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a>. Theme: <a href="https://github.com/dbtek/dbyll" target="_blank" rel="noopener noreferrer">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
	<script src="https://unpkg.com/lunr/lunr.js"></script>
	<script type="text/javascript" src="/assets/js/search.js"></script>
	<script type="text/javascript" src="/assets/js/copy-code.js"></script>
	
		<script type="text/javascript" src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js">
</script>
<script>
$(document).ready(function() {
    mermaid.initialize({
        theme: 'forest'
    });
});
</script>

	
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-164555539-1', 'auto');
  ga('send', 'pageview');
</script>

